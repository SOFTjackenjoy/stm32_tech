# 代码结构调整

**传说有人写的程序只有一个main.c，一万行，这时一个神奇的故事**

## 概述

代码结构调整有很多方式，我们这里只说最简单的。

1. 源码模块化----接口标准化
2. 硬件相关宏定义

## 源码模块化

操作：

1. 将一个功能、一个模块、一种设备的相关代码封装在同一个.c源文件中。

2. 内部使用的函数用static控制，不允许外部使用。
3. 内部的定义，比如宏、结构体。定义在c文件。
4. 这个源文件有一个相同名字的头文件。
5. 对外的定义，宏、结构体等，定义在头文件。
6. 变量只能定义在源文件，不对外暴露。

我们拿上一节的代码整理。

数码管，就是一个设备。

这个设备提供的功能是什么呢？

点亮对应的段？显示数字和小数点？

我认为点亮对应的段，才是八段数码管的根本功能。

显示数字属于应用层功能。