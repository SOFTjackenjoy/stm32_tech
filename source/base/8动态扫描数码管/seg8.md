# 动态扫描数码管

前面我们学习了如何使用一位LED显示数据，很简单是吧？

现在我们加点难度。一位数码管只能显示一位数字，现在我们要显示8位数字（或者显示时间）。

那么我们就需要8位数码管，如果按照一位数码管的用法，8位数码管就需要64根IO。

大家觉得可行吗？当然可行，我们芯片有100根管脚，80多根IO。

但是你只打算用芯片控制8位数码管吗？肯定不是嘛！这样的方案肯定是非常浪费的。

那怎么办嗯？要解决这个问题，要用到一个原理，两个芯片。

### 一个原理

不知道大家有没有了解过以前的胶片电影，一张一张的画片，连续播放就能看到活生生的人。

这时为什么呢？

> 最重要的原理是“视觉暂留”。科学实验证明，人眼在某个视像消失后，仍可使该物像在视网膜上滞留0.1－0.4秒左右。电影胶片以每秒24格画面匀速转动，一系列静态画面就会因视觉暂留作用而造成一种连续的视觉印象，产生逼真的动感。

我们在数码管上能不能用这个原理呢？

8个数码管都用同样的IO控制亮灭，轮流显示。

只要同一个LED的显示间隔不大于0.4秒（实际要比这个小），那么我们就会一直看到这个数码管是亮着的。（和真正一直亮会有什么差别？）

这样我们就只要8根IO了？

如何选择8个数码管该点亮哪个？

前面我们用共阴极数码管，我们可以用IO口控制阴极，只有对应的IO是阴极，这个数码管才有亮。

如果阴极是高电平，数码管就不会亮。

如此，我们需要8+8根IO就够了。省去了48根IO，太有成就了。

### 两个芯片

通常我们都是高兴太早，通常IO口还是不够。

那这么办呢？

我们都学过数字电路，有两个芯片能帮上我们的忙。

74HC138和74HC595。

138是三八译码器。595是8位串行输入、并行输出的位移缓存器。

> 74是一系列数字功能芯片，要注意中间字母的区别。
>
> 我们选用的是HC类型，HC表示是CMOS电平，或者简单说就是3.3V电压。

三八译码器功能是啥？看规格书真值表。

595功能呢？看规格书逻辑表。

>14 脚输入，11 脚上升沿，从14脚输入1位数据。8次之后，就有一个BYTE的数据保存在595
>这时，12脚上升沿，数据从595的引脚输出（OE需要低电平）
>
>脚复位，低电平有效 ，上电后输出高即可。

我们用三八译码器控制刷管的共阴极。595控制数码管的正极。

三八译码器决定哪个数码管亮，595决定亮的内容。

如此，我们就只需要7个IO口就搞定了。

### 硬件原理

节省IO是一种通识，所以要用8位数码管时，不是用8位单独的数码管组成。

而是用已经连接好信号的4位数码管。如下图：

![][1]

这种数码管内部已经将公用的信号连在一起。同样，也有共阴极和共阳极数码管。

内部连接信号如下:

![][2]

![][3]

电路图根据前面分析的原理设计，如下图：

![][4]

### 调试

（文字待补充，看视频更好）

第一步 ，静态显示，38译码器设定一个固定输出，固定选中一个数码管，控制595输出，让数码管显示数字。

第二步，固定显示，595输出固定值，调试38译码器，让数字在数码管上轮流显示。

第三步，将38译码器和595配合，动态刷8位数据，首先固定显示12345678。

修改，选择数码管位置，效果不对。
因为，变换内容时，要先关，怎么关？

第四步，使用显示缓冲概念，对上层屏蔽数码管细节。

第五步，修改缓冲内容，看扫描效果。

---

end



20200313



[1]: pic/pic1.jpg
[2]: pic/pic2.jpg
[3]: pic/pic3.jpg
[4]: pic/pic4.jpg

